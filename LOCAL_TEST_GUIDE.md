# 🧪 Product Master 本地测试指南

本指南将帮助您在本地环境中测试 Product Master Web 应用的功能。

## 📋 快速开始

### 1. 设置测试环境（首次使用）

```bash
# 运行设置脚本（自动创建虚拟环境并安装依赖）
./setup_local_test.sh
```

### 2. 启动Web服务器

```bash
# 方式1: 使用启动脚本（推荐）
./start_local_test.sh

# 方式2: 手动启动
source venv/bin/activate
python3 web_app.py
```

### 3. 访问应用

在浏览器中打开：
```
http://localhost:5000
```

## 🧪 功能测试清单

### ✅ 基础功能测试

- [ ] **页面加载**
  - 访问 `http://localhost:5000` 能正常显示页面
  - 页面样式正确加载（CSS文件）
  - JavaScript功能正常（无控制台错误）

- [ ] **RAG知识库状态**
  - 页面显示 "Knowledge Base (RAG)" 区域
  - 状态显示为 "Checking..." 或 "Ready"
  - 可以上传PDF文档
  - 可以重新索引文档

- [ ] **产品需求输入**
  - 输入框可以正常输入文本
  - 可以输入多行文本
  - 输入框有占位符提示

- [ ] **执行流程**
  - 点击 "Start Design" 按钮有响应
  - 执行过程显示进度（4个步骤）
  - 每个步骤的状态正确更新：
    - 📚 Product Researcher
    - 🔍 Feasibility Evaluator
    - 🎯 Result Aggregation
    - 📝 Doc Assistant

- [ ] **结果显示**
  - 执行完成后显示结果
  - 可以切换查看不同部分：
    - Product Research
    - Feasibility Evaluation
    - Final Summary
    - Product Documentation

- [ ] **执行日志**
  - 日志区域显示执行过程
  - 日志内容清晰可读
  - 错误信息（如有）正确显示

### ✅ 高级功能测试

- [ ] **RAG功能**
  - 上传PDF文档成功
  - 文档索引成功
  - 查询时能检索到相关内容

- [ ] **流式输出**
  - 执行过程中实时显示进度
  - 结果逐步显示，不是一次性加载

- [ ] **错误处理**
  - API调用失败时显示错误信息
  - 网络错误时显示友好提示
  - 输入为空时提示用户

- [ ] **响应式设计**
  - 在不同屏幕尺寸下正常显示
  - 移动设备上可用（可选）

## 🔍 测试场景

### 场景1: 基础产品分析

**输入**:
```
开发一个智能健身助手应用，帮助用户制定个性化健身计划
```

**预期结果**:
- 4个步骤全部完成
- 显示产品研究结果
- 显示可行性评估
- 显示最终总结
- 生成产品文档

### 场景2: 复杂产品需求

**输入**:
```
设计一个企业级项目管理平台，需要支持：
1. 任务分配和跟踪
2. 团队协作
3. 进度可视化
4. 报告生成
5. 移动端支持
```

**预期结果**:
- 所有步骤完成
- 结果包含详细的分析
- 可行性评估包含技术栈建议
- 文档结构完整

### 场景3: RAG知识库查询

**步骤**:
1. 上传一个产品相关的PDF文档
2. 等待索引完成
3. 输入产品需求
4. 检查结果是否引用了文档内容

**预期结果**:
- 文档上传成功
- 索引状态显示为 "Ready"
- 结果中包含文档相关内容

## 🐛 常见问题排查

### 问题1: 页面无法访问

**检查**:
```bash
# 检查服务器是否运行
ps aux | grep web_app.py

# 检查端口是否被占用
lsof -i :5000
```

**解决**:
- 确保服务器已启动
- 检查防火墙设置
- 尝试使用 `127.0.0.1:5000` 而不是 `localhost:5000`

### 问题2: 样式文件无法加载

**检查**:
```bash
# 检查静态文件目录
ls -la static/css/style.css
ls -la static/js/app.js
```

**解决**:
- 确保静态文件存在
- 检查文件权限
- 清除浏览器缓存

### 问题3: API调用失败

**检查**:
```bash
# 检查配置文件
cat config.py | grep API_KEY

# 检查日志
tail -f logs/product_master_$(date +%Y%m%d).log
```

**解决**:
- 确保 `config.py` 中配置了正确的 API_KEY
- 检查网络连接
- 查看日志文件中的错误信息

### 问题4: RAG功能不工作

**检查**:
```bash
# 检查RAG目录
ls -la knowledge_base/documents/
ls -la vector_db/chroma_db/
```

**解决**:
- 确保文档目录存在
- 检查RAG配置是否正确
- 查看日志中的RAG初始化信息

## 📊 性能测试

### 响应时间测试

- **页面加载**: < 2秒
- **API响应**: < 5秒（首次）
- **完整执行**: 根据需求复杂度，通常 30秒 - 5分钟

### 并发测试（可选）

使用工具如 `ab` 或 `wrk` 测试并发请求：

```bash
# 安装Apache Bench
brew install httpd  # macOS

# 测试并发请求
ab -n 100 -c 10 http://localhost:5000/
```

## 📝 测试报告模板

```
测试日期: [日期]
测试人员: [姓名]
测试环境: macOS/Linux/Windows
Python版本: [版本]
浏览器: [浏览器及版本]

测试结果:
- 基础功能: ✅/❌
- 高级功能: ✅/❌
- 性能: ✅/❌
- 兼容性: ✅/❌

发现的问题:
1. [问题描述]
2. [问题描述]

建议:
1. [建议内容]
2. [建议内容]
```

## 🚀 下一步

测试完成后，如果一切正常，可以：

1. **部署到生产环境**:
   ```bash
   ./deploy_to_ec2.sh
   ```

2. **查看生产环境**:
   ```
   https://productmaster.dpdns.org
   ```

3. **提交代码**:
   ```bash
   git add .
   git commit -m "测试通过的功能更新"
   git push
   ```

---

**提示**: 测试过程中如有问题，请查看日志文件：
```bash
tail -f logs/product_master_$(date +%Y%m%d).log
```
